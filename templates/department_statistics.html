{% extends 'base.html' %}

{% block title %}Статистика кафедры{% endblock %}

{% block content %}
<h1 class="my-4">Статистика кафедры: {{ department.name }}</h1>

<div class="mb-4">
    <h4>Средний рейтинг кафедры:</h4>
    <p>
        <strong>Профессионализм:</strong> {{ avg_department_rating.avg_professionalism|default:"Нет данных" }}<br>
        <strong>Доступность объяснений:</strong> {{ avg_department_rating.avg_clarity|default:"Нет данных" }}<br>
        <strong>Отношение к студентам:</strong> {{ avg_department_rating.avg_attitude|default:"Нет данных" }}
    </p>
</div>

<div class="mb-4">
    <h4>Количество преподавателей:</h4>
    <p>{{ professors|length }}</p>
</div>

<h4>Сортировать по:</h4>
<ul class="nav">
    <li class="nav-item">
        <a class="nav-link {% if sort_by == 'name' %}active{% endif %}" href="?sort=name">Имя</a>
    </li>
    <li class="nav-item">
        <a class="nav-link {% if sort_by == 'rating' %}active{% endif %}" href="?sort=rating">Рейтинг</a>
    </li>
    <li class="nav-item">
        <a class="nav-link {% if sort_by == 'reviews' %}active{% endif %}" href="?sort=reviews">Количество отзывов</a>
    </li>
</ul>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Преподаватель</th>
            <th>Средний рейтинг</th>
            <th>Количество отзывов</th>
        </tr>
    </thead>
    <tbody>
        {% for professor in professors %}
        <tr>
            <td>
                <a href="{% url 'professor_detail' professor.id %}">
                    {{ professor.name }}
                </a>
            </td>
            <td>
                {% if professor.calculated_avg_professionalism %}
                    {{ professor.calculated_avg_professionalism|floatformat:2 }}
                {% else %}
                    Нет отзывов
                {% endif %}
            </td>
            <td>{{ professor.calculated_feedback_count|default:"0" }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
